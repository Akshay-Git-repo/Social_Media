<link rel="stylesheet" href="/css/user.css">

<% if(user.id == profile_user.id){ %>
<h2 id="profile_heading">Profile</h2>
<img src="<%= user.avatar%>" alt="<%=user.name%>" width="100" height="auto" style="background-color: lightslategray; border-radius: 50%;" id="profile_photo"><br><br>
<%} %>

<% if(user.id == profile_user.id){ %>
    <!-- if user matches then show the form -->
    <form action="/users/update/<%= profile_user.id %>" method="POST" enctype="multipart/form-data" >
        <input type="text" name="name" placeholder="Your Name" value="<%= profile_user.name %>" required><br><br>
        <input type="email" name="email" placeholder="Your Email" value="<%= profile_user.email %>" required><br><br>
        <input id="imgInp" type="file" name="avatar" placeholder="Profile Picture" /><br><br>
        <input type="submit"  value="Update">
    </form>
    
<%}else{%>    
    <!-- else show only the profile info -->
    <p><%= profile_user.name %></p>
    <p><%= profile_user.email %></p>
<%} %>


<script>


function readURL(input) {
  if (input.files && input.files[0]) {
    var reader = new FileReader();
    
    reader.onload = function(e) {
        $('#profile_heading').html("Preview");
      $('#profile_photo').attr('src', e.target.result);
    }
    
    reader.readAsDataURL(input.files[0]); // convert to base64 string
  }
}

$("#imgInp").change(function() {
    
  readURL(this);
});
</script>